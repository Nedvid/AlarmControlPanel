Original source code taken from http://www.elektroda.pl/rtvforum/topic2394580.html
